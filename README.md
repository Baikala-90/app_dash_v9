# 📊 구글 시트 기반 발주량 대시보드

## 🎯 개요
이 대시보드는 구글 시트에 저장된 발주량 데이터를 자동으로 분석하여 **주간/월간/연간 비교 분석**을 제공하는 강력한 비즈니스 인텔리전스(BI) 도구입니다.

## 🚀 핵심 기능

### 📈 **주간 발주량 비교 (단기 실적 분석)**
- 가장 최근 데이터를 기준으로 '이번 주'와 '지난 주'의 5일치 발주량 비교
- 영업일 기준으로 실적 변화를 직관적으로 파악
- "이번 주 실적이 지난주 같은 요일에 비해 어떤가?" 즉시 확인

### 📊 **월간 발주량 비교 (전년 대비 성과 분석)**
- 최근 1년간의 월별 실적을 작년 같은 달과 비교
- 계절적 요인을 감안한 성과 분석
- "작년 동월 대비 올해는 얼마나 성장했는가?" 명확한 파악

### 📈 **연도별 월간 발주량 추이 (장기 트렌드 분석)**
- 수년간의 월별 데이터를 한 번에 비교
- 장기적인 관점의 계절적 패턴과 성장 추세 파악
- "매년 몇 월에 발주량이 급증하는가?" 또는 "연간 성장률이 유지되고 있는가?" 분석

## 🔧 기술 스택

### **Backend**
- **Dash**: Python 기반 웹 애플리케이션 프레임워크
- **Pandas**: 데이터 처리 및 분석
- **Plotly**: 인터랙티브 차트 생성

### **데이터 소스**
- **Google Sheets API**: 실시간 데이터 연동
- **gspread**: 구글 시트 Python 라이브러리
- **OAuth2**: 안전한 API 인증

### **UI/UX**
- **Bootstrap**: 반응형 디자인
- **한글 폰트 지원**: NanumGothic 폰트 자동 적용
- **모던한 카드 레이아웃**: 직관적인 정보 구조

## 📋 설치 및 실행

### 1️⃣ **의존성 설치**
```bash
pip install -r requirements_dash.txt
```

### 2️⃣ **구글 시트 API 설정** (선택사항)
구글 시트 데이터를 사용하려면:

1. **Google Cloud Console**에서 프로젝트 생성
2. **Google Sheets API** 활성화
3. **서비스 계정** 생성 및 키 다운로드
4. `credentials_template.json`을 `credentials.json`으로 복사하고 실제 값 입력

```bash
# credentials.json 파일이 없으면 샘플 데이터로 실행됩니다
cp credentials_template.json credentials.json
# 실제 API 키 정보로 수정
```

### 3️⃣ **애플리케이션 실행**
```bash
python app_dash.py
```

### 4️⃣ **웹 브라우저에서 접속**
```
http://127.0.0.1:8088
```

## 📊 데이터 구조

### **일별 발주량 데이터**
- **날짜**: 발주 일자
- **요일**: 요일 정보
- **총 발주 부수**: 일일 총 발주량
- **흑백페이지/컬러페이지**: 출력 유형별 분류
- **POD/경인/지방/기타**: 지역별 분류
- **담당자**: 담당자 정보

### **월별 발주량 데이터**
- **월**: 년월 정보
- **발주량**: 월별 총 발주량
- **동월비 월발주량 차**: 전년 동월 대비 증감량
- **동월비 월발주량 증감률**: 전년 동월 대비 증감률

## 🔄 자동화 기능

### **실시간 데이터 연동**
- 구글 시트 데이터 자동 동기화
- 5분마다 자동 새로고침
- 수동 새로고침 버튼 제공

### **오류 처리 및 복구**
- API 연결 실패 시 자동으로 샘플 데이터 사용
- 상세한 오류 로그 및 사용자 안내
- 안정적인 대시보드 운영

## 🎨 사용자 인터페이스

### **반응형 디자인**
- 모바일, 태블릿, 데스크톱 모든 기기 지원
- Bootstrap 5 그리드 시스템 활용
- 직관적인 카드 기반 레이아웃

### **시각적 요소**
- **주간 비교**: 꺾은선 그래프로 요일별 추이
- **월간 비교**: 그룹 막대 그래프로 전년 대비 성과
- **연간 추이**: 다중 선 그래프로 장기 트렌드
- **색상 코딩**: 일관된 색상 체계로 데이터 구분

### **사용자 경험**
- **도움말 모달**: 각 그래프의 의미와 사용법 안내
- **마지막 업데이트 시간**: 데이터 최신성 표시
- **로딩 상태 표시**: 데이터 처리 진행 상황 안내

## 🔧 커스터마이징

### **데이터 소스 변경**
- `load_data_from_gsheet()` 함수 수정으로 다른 구글 시트 연결
- `create_sample_data()` 함수 수정으로 샘플 데이터 구조 변경

### **차트 스타일 변경**
- Plotly 차트의 색상, 크기, 레이아웃 수정
- 한글 폰트 및 테마 변경

### **새로운 분석 추가**
- 새로운 API 엔드포인트 추가
- 추가 차트 및 분석 기능 구현

## 🚨 문제 해결

### **일반적인 문제**

#### 1. **구글 시트 접근 오류**
```bash
# credentials.json 파일 확인
ls -la credentials.json

# API 키 정보 확인
cat credentials.json
```

#### 2. **의존성 오류**
```bash
# 가상환경 생성 및 활성화
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 패키지 재설치
pip install -r requirements_dash.txt
```

#### 3. **포트 충돌**
```bash
# app_dash.py에서 포트 번호 변경
app.run(debug=True, host='127.0.0.1', port=8089)  # 8088 → 8089
```

#### 4. **한글 폰트 문제**
```bash
# 시스템에 NanumGothic 폰트 설치
# 또는 app_dash.py에서 font_name 변수 수정
font_name = 'Arial'  # 또는 다른 폰트명
```

### **로그 확인**
```bash
# 터미널에서 실행 로그 확인
python app_dash.py

# 브라우저 개발자 도구에서 콘솔 오류 확인
```

## 📈 성능 최적화

### **데이터 처리**
- 효율적인 pandas 데이터프레임 연산
- 메모리 사용량 최적화
- 캐싱을 통한 반복 계산 방지

### **차트 렌더링**
- Plotly의 인터랙티브 차트로 빠른 반응성
- 반응형 디자인으로 다양한 화면 크기 지원
- 최적화된 그래프 업데이트 로직

## 🔒 보안 고려사항

### **API 키 관리**
- `credentials.json` 파일을 `.gitignore`에 추가
- 환경 변수를 통한 민감 정보 관리
- 서비스 계정 권한 최소화

### **데이터 접근 제어**
- 구글 시트 공유 설정 확인
- 읽기 전용 권한으로 API 접근
- 정기적인 접근 권한 검토

## 🚀 향후 개발 계획

### **단기 계획**
- [ ] 데이터 내보내기 기능 (Excel, PDF)
- [ ] 이메일 알림 기능
- [ ] 모바일 앱 최적화

### **장기 계획**
- [ ] 머신러닝 기반 예측 분석
- [ ] 다중 구글 시트 지원
- [ ] 사용자 권한 관리 시스템

## 📞 지원 및 문의

### **기술 지원**
- GitHub Issues를 통한 버그 리포트
- 기능 제안 및 개선 아이디어 환영
- 코드 리뷰 및 기여

### **문서 및 가이드**
- 상세한 API 문서
- 사용자 매뉴얼
- 비디오 튜토리얼

## 📄 라이선스

이 프로젝트는 교육 및 개발 목적으로 제작되었습니다. 상업적 사용 시 별도 문의가 필요합니다.

---

**🎉 이 대시보드로 발주량 데이터를 더욱 스마트하게 분석하고, 비즈니스 인사이트를 발견하세요!**
